{
  "hash": "085eeccc378bbf1f297955e2e5f66a15",
  "result": {
    "engine": "knitr",
    "markdown": "# Notes {-}\n\n## What is classification?\n> Predicting classification a qualitative response for an observation can be referred to as classifying that observation, since it involves assigning the observation to a category, or class.\n\n### Some questions that can be solved with classification\n- A person arrives at the emergency room with a set of symptoms that could possibly be attributed to one of three medical conditions. Which of the three conditions does the individual have?\n- An online banking service must be able to determine whether or not a transaction being performed on the site is fraudulent, on the basis of the  user’s IP address, past transaction history, and so forth.\n- On the basis of DNA sequence data for a number of patients with and without a given disease, a biologist would like to figure out which DNA mutations are deleterious (disease-causing) and which are not.\n\n### Why not linear regression?\n\n- Linear regression should not be used to predict a qualitative or categorical variable with more than 2 levels that does not have a natural ordering\n- Linear regression should not be used to predict a qualitative or categorical variable with more than 2 levels that does not have a reasonably similar gap between each level. \n- If your qualitative outcome variable only has 2 levels you could recode it as a dummy variable with 0/1 coding. This is not recommmended because the probability estimates will probably not be meaningful, for example have negative probabilities. \n- A linear regression model to predict the relationship between `default` and `balance` leads to negative probabilities of default for bank balances close to zero.\n\nExamples of categorical variables that are not appropriate as outcome variables for linear regression?\n\n## Logistic Regression\n> Rather than modeling this response $Y$ directly, logistic regression models the probability that $Y$ belongs to a particular category\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Figure 4.2](images/04-fig4_2.png){width=100%}\n:::\n:::\n\n\nClassification using the `Default` data. Left: Estimated probability of `default` using linear regression. Some estimated probabilities are negative! The orange ticks indicate the 0/1 values coded for `default` (`No` or `Yes`). Right: Predicted probabilities of `default` using logistic regression. All probabilities lie between 0 and 1.\n\n- logistic regression uses a logistic function which gives probability estimates between 0 and 1 for all values of $X$. \n- a logistic function will always produce an S-shaped curve, probabilities will come close to but never below zero and close but never above one.\n- probability of response $Y$ can be predicted based on any value of $X$. \n- ${\\beta_1}$ in linear regression is the average change in $Y$ associated with a one-unit increase in $X$. By contrast, in a logistic regression model, increasing $X$ by one unit changes the log odds by ${\\beta_1}$\n- regardless of the value of $X$, if ${\\beta_1}$ is positive then increasing $X$ will be associated with increasing $p(X)$, and if ${\\beta_1}$ is negative then increasing $X$ will be associated with decreasing $p(X)$.\n\n\n$$p(X) = β_0 + β_1X \\space \\Longrightarrow {Linear \\space regression}$$\n$$p (X) =  \\frac{e^{\\beta_{0} + \\beta_{1}X}}{1 + e^{\\beta_{0} + \\beta_{1}X}} \\space \\Longrightarrow {Logistic \\space function}$$\n$$odds = \\frac{p (X)}{1 - p (X)} =  e^{\\beta_{0} + \\beta_{1}X} \\Longrightarrow {odds \\space value [0, ∞]}$$\n\n### Maximum Likelihood\nUsing maximum likelihood, the regression coefficients are chosen based on the probability estimates being as close as possible to the observed response of $Y$ for each case in the training data.\n> The estimates $\\hat{\\beta_0}$ and $\\hat{\\beta_1}$ are chosen to maximize this likelihood function.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![For the `Default` data, estimated coefficients of the logistic regression model that predicts the probability of `default` using `balance`. A one-unit increase in `balance` is associated with an increase in the log odds of `default` by 0.0055 units.](images/04-tab4_1.png){width=100%}\n:::\n:::\n\n\n### Making Predictions\n\nOnce we have our estimated coefficients we can input any value of $X$ into the model and predict the probability of $Y$. Using the bank example, we can predict `default` based on any `balance`. \n\n### Qualitative predictors\nInstead of a quantitative predictor like credit balance, we could use a qualitative, or categorical, variable, like whether or not someone is a student, to predict whether or not someone will default. \n\n## Multiple Logistic Regression\nThe equation for simple logistic regression can be rewritten to include coefficient estimates for $p$ predictors. \n\n$$\\log \\biggl(\\frac{p(X)}{1- p(X)}\\bigg) = \\beta_{0} + \\beta_{1}X_1 + ... + \\beta_{p}X_p$$\n$$p(X) = \\frac{e^{\\beta_{0} + \\beta_{1}X_1 + ... + \\beta_{p}X_p}}{1 + e^{\\beta_{0} + \\beta_{1}X_1 + ... + \\beta_{p}X_p}}$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Figure 4.3](images/04-fig4_3.png){width=100%}\n:::\n:::\n\n\nConfounding in the Default data. Left: Default rates are shown for students (orange) and non-students (blue). The solid lines display  default rate as a function of balance, while the horizontal broken lines display the overall default rates. Right: Boxplots of balance for students (orange) and non-students (blue) are shown.\n\n## Multinomial  Logistic Regression\n- This is used in the setting where K > 2 classes. In multinomial, we select a single class to serve as the baseline.\n\n- However, the interpretation of the coefficients in a multinomial logistic regression model must be done with care, since it is tied to the choice of baseline. \n\n- Alternatively, you can use `Softmax coding, where we treat all K classes symmetrically, and assume that for k = 1, . . . ,K, rather than selecting a baseline. This means, we estimate coefficients for all K classes, rather than estimating coefficients for K − 1 classes. \n\n\n## Generative Models for Classification\n>  model the distribution of the predictors X separately in each of the response classes (i.e. for each value of Y ).\n\n$\\pi_k$ = overall or prior probability that a randomly chosen observation comes from kth class\n\n$f_k(X) \\equiv \\Pr(X \\mid Y = k)$ = the density function of $X$ for an observation that comes from the $k$th class. It is relatively large if there is a high probability that an observation in the $k$th class has $X \\approx x$, and $f_k(X)$ is small if it is very unlikely that an observation in the $k$th class has $X \\approx x$.\n\n$p_k(X)$ is the probability that the observation belongs to the kth class, given the predictor value for that observation.\n\n\n### 3 classifiers to approximate the Bayes classifier\n\n- Linear Discriminant Analysis\n- Quadratic Discriminant Analysis\n- Naive Bayes\n\n\n## Comparison of classification methods\n\n\n\n\n## Poisson Regression\n\n**Poisson distribution** is typically used to model counts. In a poisson distribution, \n\nWhen $Y$ is neither quantitative (sales) nor qualitative (whether or not someone will default on a loan). \nSimilarly to predicting the probability of qualitative variables, negative predictions of count data are not meaningful. \n\n\n### Why not linear regression?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Figure 4.13](images/04-fig4_13.png){width=100%}\n:::\n:::\n\n\nLeft: The coefficients associated with the month of the year. Bike usage is highest in the spring and fall, and lowest in the winter. Right: The coefficients associated with the hour of the day. Bike usage is highest during peak commute times, and lowest overnight.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Figure 4.14](images/04-fig4_14.png){width=100%}\n:::\n:::\n\n\n\nLeft: On the Bikeshare dataset, the number of bikers is displayed on the y-axis, and the hour of the day is displayed on the x-axis. For the most part, as the mean number of bikers increases, so does the variance in the number of bikers, violating the assumption of homoscedasticity. A smoothing spline fit is shown in green. Right: The log of the number of bikers is now displayed on the y-axis.\n\n\n\n\n\n## Generalized Linear Models",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}